#include <stdio.h>
#include <stdlib.h>
#include <locale.h>
#define QuantidadeProdutosMaximo 2

struct Produto{
  int Id;
  char Nome[50];
  char Descricao[100];
  float Preco;
  char Data[11];
  int Quantidade;
};

void Menu();
struct Produto InsereProdutos(int contador);
void AlteraProdutos();
void ExcluiProdutos();
void ListaProdutos();
void PesquisaProdutos();
void MostraProduto(struct Produto produtos);
void LimpaTela();

int main(int argc, char *argv[]) {
    setlocale(LC_ALL,"Portuguese");
	Menu();
	
	return 0;
}

void Menu(){
	int resposta;
	struct Produto produtos[QuantidadeProdutosMaximo];
	int contador = 0;
	
	do{
		printf("O que você deseja fazer??\n1)Inserir Produtos\n2)Alterar Produtos\n3)Excluir produtos\n4)Pesquisar produtos\n5)Listar todos os produtos do estoque e de um departamento\n6)Sair\nEscolha: ");
		fflush(stdin);
		scanf("%i", &resposta);
		
		switch(resposta){
			case 1:
				if(contador < QuantidadeProdutosMaximo){
					printf("\n-------Inserir um produto-------\n\n");
					produtos[contador] = InsereProdutos(contador);
					contador++;	
				}else
					printf("\nQuantidade Máxima de produtos cadastrados!!\n\n");
					
				LimpaTela();
				break;
			case 2: 
				printf("\n-------Alterar um produto-------\n\n");
				AlteraProdutos(produtos[QuantidadeProdutosMaximo]);
				LimpaTela();
				break;
			case 3:
				if(contador > 0){
					printf("\n-------Excluir um produto-------\n\n");
					ExcluiProdutos(produtos[QuantidadeProdutosMaximo]);
					contador--;
				}
				else
					printf("\nVoce não tem produtos cadastrados!!\n\n");
					
				LimpaTela();
				break;
			case 4: 
				printf("\n-------Pesquisar um produto-------\n\n");
				PesquisaProdutos(produtos);
				LimpaTela();
				break;
			case 5: 
				printf("\n-------Lista de produtos-------\n");
				ListaProdutos(produtos);
				LimpaTela();
				break;
			case 6: 
				printf("\nSaindo....\n");
				break;
			default:
				printf("\nInsira uma opcao correta!\n");
				break;
		}
	}while(resposta != 6);
}

struct Produto InsereProdutos(int contador){
	struct Produto produto;
	
	printf("Qual o nome do teu produto: ");
	fflush(stdin);
	fgets(produto.Nome, 50, stdin);
	
	printf("Qual a descrição do teu produto: ");
	fflush(stdin);
	fgets(produto.Descricao, 100, stdin);
	
	printf("Qual o preço do teu produto: ");
	fflush(stdin);
	scanf("%f", &produto.Preco);
	
	printf("Qual a data de validade do teu produto: ");
	fflush(stdin);
	fgets(produto.Data, 11, stdin);
	
	printf("Qual a quantidade do teu produto: ");
	fflush(stdin);
	scanf("%i", &produto.Quantidade);
	
	produto.Id = contador;
	
	return produto;
}

void AlteraProdutos(){
	
}

void ExcluiProdutos(){
	
}

void PesquisaProdutos(struct Produto produtos[QuantidadeProdutosMaximo]){
	int escolha = 0 , i = 0;
	
	do{
		printf("Você quer pesquisar o produto pelo: \n1)Id\n2)Nome\n3)Sair\nEscolha: ");
		fflush(stdin);
		scanf("%i", &escolha);
	
		if(escolha == 1){
		    int id = -2;
		    
			printf("Insira o Id do produto que voce deseja procurar: ");
			fflush(stdin);
			scanf("%i", &id);
			
			for(i = 0; i < QuantidadeProdutosMaximo; i++){
			    if(produtos[i].Id == id && produtos[i].Nome[0] >= 'a' && produtos[i].Nome[0] <= 'z' || produtos[i].Nome[0] >= 'A' && produtos[i].Nome[0] <= 'Z'){
			        MostraProduto(produtos[i]);
			    }
			    printf("\n");
			}
			
		}else if(escolha == 2){
		    char nome[50];
			printf("Insira o nome do produto que voce deseja procurar: ");
			fflush(stdin);
	        fgets(nome, 50, stdin);
			
			for(i = 0; i < QuantidadeProdutosMaximo; i++){
			    if(strstr(produtos[i].Nome, nome) != NULL){
			        MostraProduto(produtos[i]);
			    }
			    printf("\n");
			}
			
		}else if(escolha == 3)
			break;
		else
			printf("\nInsira um opcao valida!!");
			
	}while(escolha != 3);
}

void ListaProdutos(struct Produto produtos[QuantidadeProdutosMaximo]){
	int i;
	
	for(i = 0; i < QuantidadeProdutosMaximo; i++){
		if(produtos[i].Nome[0] >= 'a' && produtos[i].Nome[0] <= 'z' || produtos[i].Nome[0] >= 'A' && produtos[i].Nome[0] <= 'Z'){
		    MostraProduto(produtos[i]);
		}
		printf("\n");
	}
}

void MostraProduto(struct Produto produtos){
    printf("\n----------Produto ----------");
    printf("\nNome: %s", produtos.Nome);
    printf("Descrição: %s", produtos.Descricao);
    printf("Preço: %f", produtos.Preco);
    printf("\nData de Validade: %s\n", produtos.Data);
    printf("Quantidade: %i", produtos.Quantidade);
}

void LimpaTela(){
	printf("\nAperte ENTER para continuar: ");
	fflush(stdin);
	getchar();
	system("cls");
}
